<?php

namespace Test\Logger\Unit;

use Debuggertools\Logger;

use Test\ExtendClass\BaseTestCase;

class TextTest extends BaseTestCase
{

    public function setUp(): void
    {
        parent::setUp();
        $this->purgeLog();
        $this->Logger = new Logger(['hidePrefix' => 1]);
    }

    public function testLongText()
    {
        $text = "#1 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec vel sapien non metus laoreet tincidunt. Nam euismod, felis at tincidunt posuere, ante est maximus purus, et porttitor lorem sapien sit amet magna.\n#2 Vivamus quis lacus eget justo pretium viverra. Etiam fermentum libero ut malesuada efficitur. Integer lacinia turpis id magna suscipit, et gravida metus accumsan.\n#3 Suspendisse potenti. Aenean convallis erat nec justo vehicula, at fermentum libero volutpat. Nunc ut turpis odio. Nam sed orci sed nulla cursus tempor a vel est.\n#4 Mauris luctus purus in augue porttitor, at consectetur leo gravida. Aenean sit amet purus sit amet nisi sagittis eleifend nec eu turpis. In hac habitasse platea dictumst.\n#5 Sed scelerisque sapien ut augue interdum, nec eleifend ex placerat. Praesent lobortis justo a elit consectetur, a egestas eros malesuada.\n#6 Quisque at urna ac neque dignissim vehicula a ut eros. In hac habitasse platea dictumst. Donec nec ligula et turpis ullamcorper consectetur. Phasellus non vehicula lorem.\n#7 Nam in dui id libero tempor fringilla. Sed vehicula orci non tortor pulvinar, nec convallis nulla pretium. Morbi sit amet ligula a nisl dapibus euismod. Curabitur nec venenatis urna.\n#8 Nullam eget justo vel orci ultricies suscipit nec at lectus. Nam vehicula nisi vel enim dignissim, non gravida elit aliquam. Fusce venenatis augue et arcu dictum lacinia.\n#9 In finibus, mauris eu malesuada dictum, urna ipsum tempus nisi, vitae condimentum felis odio ac turpis. Ut vehicula mi in urna vehicula lacinia. Fusce sit amet ultricies ligula.\n#10 Ut faucibus lorem at arcu ultricies gravida. Donec eu lorem ac mauris pretium consequat. Suspendisse potenti. Phasellus sagittis metus vel enim suscipit, a tristique sapien volutpat.\n#11 Duis sagittis augue non turpis suscipit, in faucibus mauris consequat. Integer lacinia nulla ut tincidunt tincidunt. Etiam nec leo malesuada, interdum enim nec, interdum felis.\n#12 Pellentesque vel nulla id velit consequat pharetra a et arcu. Curabitur varius, libero non fringilla suscipit, ex erat malesuada mi, vel consequat odio lorem nec sapien.\n#13 Sed tincidunt ligula in nulla eleifend, ac varius nunc feugiat. Proin at nisl in magna varius aliquet nec non velit. Morbi dignissim enim ac leo faucibus, non luctus sapien convallis.\n#14 Aliquam in urna quis ligula ultricies facilisis. Ut venenatis erat a dolor bibendum, id fermentum risus convallis. Vivamus varius metus non orci placerat, eget dapibus orci pretium.\n#15 Etiam a erat eget purus posuere auctor vel non dolor. Fusce a lacus accumsan, vulputate nisl sed, congue nisi. Nulla a justo id orci pulvinar dictum eget nec odio.\n#16 Morbi mollis magna vel vehicula lacinia. Nulla facilisi. Curabitur sit amet ante ligula. Quisque non dui nec justo vulputate aliquam. Sed suscipit sapien a erat tincidunt fermentum.\n#17 Curabitur dapibus justo vel diam varius, sed varius magna accumsan. Praesent eget tortor ac eros efficitur viverra vel sed nunc.\n#18 Fusce tincidunt ex id libero laoreet, in bibendum nunc blandit. Nam ac erat et dui efficitur ultrices. Donec ac odio non mi ornare congue.\n#19 Proin sit amet elit non ligula fermentum sodales non nec odio. Ut sit amet risus a nulla aliquet varius in at elit.\n#20 Vivamus in felis ut ex ornare lobortis. Aenean ac lectus quis orci sollicitudin finibus. Donec venenatis purus id mauris fringilla tincidunt.\n#21 Sed gravida purus non turpis scelerisque lacinia. Ut non justo euismod, varius ligula in, scelerisque urna. In a purus euismod.\n#22 Integer vestibulum lorem sit amet ante blandit, id malesuada ex vestibulum. Nam ac magna sed lectus vehicula lacinia ut sit amet enim.";
        $this->Logger->logger($text);
        $this->assertMatchesRegularExpression('/#1 Lorem ipsum dolor sit amet, consectetur adipiscing elit\. Donec vel sapien non metus laoreet tincidunt\. Nam euismod, felis at tincidunt posuere, ante est maximus purus, et porttitor lorem sapien sit amet magna\.\n#2/', $this->getContent());
        $this->assertMatchesRegularExpression('/#2 Vivamus quis lacus eget justo pretium viverra\. Etiam fermentum libero ut malesuada efficitur\. Integer lacinia turpis id magna suscipit, et gravida metus accumsan\.\n#3/', $this->getContent());
        $this->assertMatchesRegularExpression('/#3 Suspendisse potenti\. Aenean convallis erat nec justo vehicula, at fermentum libero volutpat\. Nunc ut turpis odio\. Nam sed orci sed nulla cursus tempor a vel est\.\n#4/', $this->getContent());
        $this->assertMatchesRegularExpression('/#4 Mauris luctus purus in augue porttitor, at consectetur leo gravida\. Aenean sit amet purus sit amet nisi sagittis eleifend nec eu turpis\. In hac habitasse platea dictumst\.\n#5/', $this->getContent());
        $this->assertMatchesRegularExpression('/#5 Sed scelerisque sapien ut augue interdum, nec eleifend ex placerat\. Praesent lobortis justo a elit consectetur, a egestas eros malesuada\.\n#6/', $this->getContent());
        $this->assertMatchesRegularExpression('/#6 Quisque at urna ac neque dignissim vehicula a ut eros\. In hac habitasse platea dictumst\. Donec nec ligula et turpis ullamcorper consectetur\. Phasellus non vehicula lorem\.\n#7/', $this->getContent());
        $this->assertMatchesRegularExpression('/#7 Nam in dui id libero tempor fringilla\. Sed vehicula orci non tortor pulvinar, nec convallis nulla pretium\. Morbi sit amet ligula a nisl dapibus euismod\. Curabitur nec venenatis urna\.\n#8/', $this->getContent());
        $this->assertMatchesRegularExpression('/#8 Nullam eget justo vel orci ultricies suscipit nec at lectus\. Nam vehicula nisi vel enim dignissim, non gravida elit aliquam\. Fusce venenatis augue et arcu dictum lacinia\.\n#9/', $this->getContent());
        $this->assertMatchesRegularExpression('/#9 In finibus, mauris eu malesuada dictum, urna ipsum tempus nisi, vitae condimentum felis odio ac turpis\. Ut vehicula mi in urna vehicula lacinia\. Fusce sit amet ultricies ligula\.\n#10/', $this->getContent());
        $this->assertMatchesRegularExpression('/#10 Ut faucibus lorem at arcu ultricies gravida\. Donec eu lorem ac mauris pretium consequat\. Suspendisse potenti\. Phasellus sagittis metus vel enim suscipit, a tristique sapien volutpat\.\n#11/', $this->getContent());
        $this->assertMatchesRegularExpression('/#11 Duis sagittis augue non turpis suscipit, in faucibus mauris consequat\. Integer lacinia nulla ut tincidunt tincidunt\. Etiam nec leo malesuada, interdum enim nec, interdum felis\.\n#12/', $this->getContent());
        $this->assertMatchesRegularExpression('/#12 Pellentesque vel nulla id velit consequat pharetra a et arcu\. Curabitur varius, libero non fringilla suscipit, ex erat malesuada mi, vel consequat odio lorem nec sapien\.\n#13/', $this->getContent());
        $this->assertMatchesRegularExpression('/#13 Sed tincidunt ligula in nulla eleifend, ac varius nunc feugiat\. Proin at nisl in magna varius aliquet nec non velit\. Morbi dignissim enim ac leo faucibus, non luctus sapien convallis\.\n#14/', $this->getContent());
        $this->assertMatchesRegularExpression('/#14 Aliquam in urna quis ligula ultricies facilisis\. Ut venenatis erat a dolor bibendum, id fermentum risus convallis\. Vivamus varius metus non orci placerat, eget dapibus orci pretium\.\n#15/', $this->getContent());
        $this->assertMatchesRegularExpression('/#15 Etiam a erat eget purus posuere auctor vel non dolor\. Fusce a lacus accumsan, vulputate nisl sed, congue nisi\. Nulla a justo id orci pulvinar dictum eget nec odio\.\n#16/', $this->getContent());
        $this->assertMatchesRegularExpression('/#16 Morbi mollis magna vel vehicula lacinia\. Nulla facilisi\. Curabitur sit amet ante ligula\. Quisque non dui nec justo vulputate aliquam\. Sed suscipit sapien a erat tincidunt fermentum\.\n#17/', $this->getContent());
        $this->assertMatchesRegularExpression('/#17 Curabitur dapibus justo vel diam varius, sed varius magna accumsan\. Praesent eget tortor ac eros efficitur viverra vel sed nunc\.\n#18/', $this->getContent());
        $this->assertMatchesRegularExpression('/#18 Fusce tincidunt ex id libero laoreet, in bibendum nunc blandit\. Nam ac erat et dui efficitur ultrices\. Donec ac odio non mi ornare congue\.\n#19/', $this->getContent());
        $this->assertMatchesRegularExpression('/#19 Proin sit amet elit non ligula fermentum sodales non nec odio\. Ut sit amet risus a nulla aliquet varius in at elit\.\n#20/', $this->getContent());
        $this->assertMatchesRegularExpression('/#20 Vivamus in felis ut ex ornare lobortis\. Aenean ac lectus quis orci sollicitudin finibus\. Donec venenatis purus id mauris fringilla tincidunt\.\n#21/', $this->getContent());
        $this->assertMatchesRegularExpression('/#21 Sed gravida purus non turpis scelerisque lacinia\. Ut non justo euismod, varius ligula in, scelerisque urna\. In a purus euismod\.\n#22/', $this->getContent());
        $this->assertMatchesRegularExpression('/#22 Integer vestibulum lorem sit amet ante blandit, id malesuada ex vestibulum\. Nam ac magna sed lectus vehicula lacinia ut sit amet enim\.\n*$/', $this->getContent());
    }

    public function testLongTextAndLogAfter()
    {
        $text = "#1 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec vel sapien non metus laoreet tincidunt. Nam euismod, felis at tincidunt posuere, ante est maximus purus, et porttitor lorem sapien sit amet magna.\n#2 Vivamus quis lacus eget justo pretium viverra. Etiam fermentum libero ut malesuada efficitur. Integer lacinia turpis id magna suscipit, et gravida metus accumsan.\n#3 Suspendisse potenti. Aenean convallis erat nec justo vehicula, at fermentum libero volutpat. Nunc ut turpis odio. Nam sed orci sed nulla cursus tempor a vel est.\n#4 Mauris luctus purus in augue porttitor, at consectetur leo gravida. Aenean sit amet purus sit amet nisi sagittis eleifend nec eu turpis. In hac habitasse platea dictumst.\n#5 Sed scelerisque sapien ut augue interdum, nec eleifend ex placerat. Praesent lobortis justo a elit consectetur, a egestas eros malesuada.\n#6 Quisque at urna ac neque dignissim vehicula a ut eros. In hac habitasse platea dictumst. Donec nec ligula et turpis ullamcorper consectetur. Phasellus non vehicula lorem.\n#7 Nam in dui id libero tempor fringilla. Sed vehicula orci non tortor pulvinar, nec convallis nulla pretium. Morbi sit amet ligula a nisl dapibus euismod. Curabitur nec venenatis urna.\n#8 Nullam eget justo vel orci ultricies suscipit nec at lectus. Nam vehicula nisi vel enim dignissim, non gravida elit aliquam. Fusce venenatis augue et arcu dictum lacinia.\n#9 In finibus, mauris eu malesuada dictum, urna ipsum tempus nisi, vitae condimentum felis odio ac turpis. Ut vehicula mi in urna vehicula lacinia. Fusce sit amet ultricies ligula.\n#10 Ut faucibus lorem at arcu ultricies gravida. Donec eu lorem ac mauris pretium consequat. Suspendisse potenti. Phasellus sagittis metus vel enim suscipit, a tristique sapien volutpat.\n#11 Duis sagittis augue non turpis suscipit, in faucibus mauris consequat. Integer lacinia nulla ut tincidunt tincidunt. Etiam nec leo malesuada, interdum enim nec, interdum felis.\n#12 Pellentesque vel nulla id velit consequat pharetra a et arcu. Curabitur varius, libero non fringilla suscipit, ex erat malesuada mi, vel consequat odio lorem nec sapien.\n#13 Sed tincidunt ligula in nulla eleifend, ac varius nunc feugiat. Proin at nisl in magna varius aliquet nec non velit. Morbi dignissim enim ac leo faucibus, non luctus sapien convallis.\n#14 Aliquam in urna quis ligula ultricies facilisis. Ut venenatis erat a dolor bibendum, id fermentum risus convallis. Vivamus varius metus non orci placerat, eget dapibus orci pretium.\n#15 Etiam a erat eget purus posuere auctor vel non dolor. Fusce a lacus accumsan, vulputate nisl sed, congue nisi. Nulla a justo id orci pulvinar dictum eget nec odio.\n#16 Morbi mollis magna vel vehicula lacinia. Nulla facilisi. Curabitur sit amet ante ligula. Quisque non dui nec justo vulputate aliquam. Sed suscipit sapien a erat tincidunt fermentum.\n#17 Curabitur dapibus justo vel diam varius, sed varius magna accumsan. Praesent eget tortor ac eros efficitur viverra vel sed nunc.\n#18 Fusce tincidunt ex id libero laoreet, in bibendum nunc blandit. Nam ac erat et dui efficitur ultrices. Donec ac odio non mi ornare congue.\n#19 Proin sit amet elit non ligula fermentum sodales non nec odio. Ut sit amet risus a nulla aliquet varius in at elit.\n#20 Vivamus in felis ut ex ornare lobortis. Aenean ac lectus quis orci sollicitudin finibus. Donec venenatis purus id mauris fringilla tincidunt.\n#21 Sed gravida purus non turpis scelerisque lacinia. Ut non justo euismod, varius ligula in, scelerisque urna. In a purus euismod.\n#22 Integer vestibulum lorem sit amet ante blandit, id malesuada ex vestibulum. Nam ac magna sed lectus vehicula lacinia ut sit amet enim.";
        $this->Logger->logger($text);
        $this->Logger->logger('after');
        $this->assertMatchesRegularExpression('/#1 Lorem ipsum dolor sit amet, consectetur adipiscing elit\. Donec vel sapien non metus laoreet tincidunt\. Nam euismod, felis at tincidunt posuere, ante est maximus purus, et porttitor lorem sapien sit amet magna\.\n#2/', $this->getContent());
        $this->assertMatchesRegularExpression('/#2 Vivamus quis lacus eget justo pretium viverra\. Etiam fermentum libero ut malesuada efficitur\. Integer lacinia turpis id magna suscipit, et gravida metus accumsan\.\n#3/', $this->getContent());
        $this->assertMatchesRegularExpression('/#3 Suspendisse potenti\. Aenean convallis erat nec justo vehicula, at fermentum libero volutpat\. Nunc ut turpis odio\. Nam sed orci sed nulla cursus tempor a vel est\.\n#4/', $this->getContent());
        $this->assertMatchesRegularExpression('/#4 Mauris luctus purus in augue porttitor, at consectetur leo gravida\. Aenean sit amet purus sit amet nisi sagittis eleifend nec eu turpis\. In hac habitasse platea dictumst\.\n#5/', $this->getContent());
        $this->assertMatchesRegularExpression('/#5 Sed scelerisque sapien ut augue interdum, nec eleifend ex placerat\. Praesent lobortis justo a elit consectetur, a egestas eros malesuada\.\n#6/', $this->getContent());
        $this->assertMatchesRegularExpression('/#6 Quisque at urna ac neque dignissim vehicula a ut eros\. In hac habitasse platea dictumst\. Donec nec ligula et turpis ullamcorper consectetur\. Phasellus non vehicula lorem\.\n#7/', $this->getContent());
        $this->assertMatchesRegularExpression('/#7 Nam in dui id libero tempor fringilla\. Sed vehicula orci non tortor pulvinar, nec convallis nulla pretium\. Morbi sit amet ligula a nisl dapibus euismod\. Curabitur nec venenatis urna\.\n#8/', $this->getContent());
        $this->assertMatchesRegularExpression('/#8 Nullam eget justo vel orci ultricies suscipit nec at lectus\. Nam vehicula nisi vel enim dignissim, non gravida elit aliquam\. Fusce venenatis augue et arcu dictum lacinia\.\n#9/', $this->getContent());
        $this->assertMatchesRegularExpression('/#9 In finibus, mauris eu malesuada dictum, urna ipsum tempus nisi, vitae condimentum felis odio ac turpis\. Ut vehicula mi in urna vehicula lacinia\. Fusce sit amet ultricies ligula\.\n#10/', $this->getContent());
        $this->assertMatchesRegularExpression('/#10 Ut faucibus lorem at arcu ultricies gravida\. Donec eu lorem ac mauris pretium consequat\. Suspendisse potenti\. Phasellus sagittis metus vel enim suscipit, a tristique sapien volutpat\.\n#11/', $this->getContent());
        $this->assertMatchesRegularExpression('/#11 Duis sagittis augue non turpis suscipit, in faucibus mauris consequat\. Integer lacinia nulla ut tincidunt tincidunt\. Etiam nec leo malesuada, interdum enim nec, interdum felis\.\n#12/', $this->getContent());
        $this->assertMatchesRegularExpression('/#12 Pellentesque vel nulla id velit consequat pharetra a et arcu\. Curabitur varius, libero non fringilla suscipit, ex erat malesuada mi, vel consequat odio lorem nec sapien\.\n#13/', $this->getContent());
        $this->assertMatchesRegularExpression('/#13 Sed tincidunt ligula in nulla eleifend, ac varius nunc feugiat\. Proin at nisl in magna varius aliquet nec non velit\. Morbi dignissim enim ac leo faucibus, non luctus sapien convallis\.\n#14/', $this->getContent());
        $this->assertMatchesRegularExpression('/#14 Aliquam in urna quis ligula ultricies facilisis\. Ut venenatis erat a dolor bibendum, id fermentum risus convallis\. Vivamus varius metus non orci placerat, eget dapibus orci pretium\.\n#15/', $this->getContent());
        $this->assertMatchesRegularExpression('/#15 Etiam a erat eget purus posuere auctor vel non dolor\. Fusce a lacus accumsan, vulputate nisl sed, congue nisi\. Nulla a justo id orci pulvinar dictum eget nec odio\.\n#16/', $this->getContent());
        $this->assertMatchesRegularExpression('/#16 Morbi mollis magna vel vehicula lacinia\. Nulla facilisi\. Curabitur sit amet ante ligula\. Quisque non dui nec justo vulputate aliquam\. Sed suscipit sapien a erat tincidunt fermentum\.\n#17/', $this->getContent());
        $this->assertMatchesRegularExpression('/#17 Curabitur dapibus justo vel diam varius, sed varius magna accumsan\. Praesent eget tortor ac eros efficitur viverra vel sed nunc\.\n#18/', $this->getContent());
        $this->assertMatchesRegularExpression('/#18 Fusce tincidunt ex id libero laoreet, in bibendum nunc blandit\. Nam ac erat et dui efficitur ultrices\. Donec ac odio non mi ornare congue\.\n#19/', $this->getContent());
        $this->assertMatchesRegularExpression('/#19 Proin sit amet elit non ligula fermentum sodales non nec odio\. Ut sit amet risus a nulla aliquet varius in at elit\.\n#20/', $this->getContent());
        $this->assertMatchesRegularExpression('/#20 Vivamus in felis ut ex ornare lobortis\. Aenean ac lectus quis orci sollicitudin finibus\. Donec venenatis purus id mauris fringilla tincidunt\.\n#21/', $this->getContent());
        $this->assertMatchesRegularExpression('/#21 Sed gravida purus non turpis scelerisque lacinia\. Ut non justo euismod, varius ligula in, scelerisque urna\. In a purus euismod\.\n#22/', $this->getContent());
        $this->assertMatchesRegularExpression('/#22 Integer vestibulum lorem sit amet ante blandit, id malesuada ex vestibulum\. Nam ac magna sed lectus vehicula lacinia ut sit amet enim\.\n/', $this->getContent());
        $this->assertMatchesRegularExpression('/after\n$/', $this->getContent());
    }
}
